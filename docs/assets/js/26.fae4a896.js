(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{388:function(s,t,a){"use strict";a.r(t);var e=a(19),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#脚本"}},[s._v("#")]),s._v(" 脚本")]),s._v(" "),a("h2",{attrs:{id:"安防数据库初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安防数据库初始化"}},[s._v("#")]),s._v(" 安防数据库初始化")]),s._v(" "),a("ol",[a("li",[s._v("将现场数据库数据导出，首先进入现场数据库处理空表问题，执行以下脚本")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("--由于oracle10是默认不导出空表,所以需修改它各表的配置,让它设置成非空\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'alter table '")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" owner "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v("table_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("' allocate extent;'")]),s._v(" from all_tables where owner like "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'IOT%'")]),s._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("处理空表之后将数据全部导出到E盘备份目录下（也可导出到其他地方，改动下路径即可），打开DOS命令执行以下命令，之后耐心等待")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("exp ioticore/imcsoft.12345 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("file")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("E:/iotimc/backup/xj201910301530.dmp "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("full")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("y\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("拿到现场数据之后，导入到你要搭建的测试服务器中，先打开创建好的oracle IOTIMC数据库，执行以下脚本")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("--执行如下脚本,然后复制查询结果执行\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'drop table '")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" table_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("';'")]),s._v(" from all_tables where owner "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'IOTICORE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("打开DOS命令执行以下命令，命令中的路径为你在现场所拿到的现场数据dmp，如果不相同请修改，执行之后请耐心等待即可")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("imp ioticore/imcsoft.12345 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("file")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("E:/iotimc/backup/xj201910301530.dmp "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("full")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("y "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ignore")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Y\n")])])]),a("h2",{attrs:{id:"添加业务权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加业务权限"}},[s._v("#")]),s._v(" 添加业务权限")]),s._v(" "),a("p",[s._v("查找表"),a("code",[s._v("symenu")]),s._v("过滤"),a("code",[s._v("type = 'role'")]),a("br"),s._v("\n然后 在字段"),a("code",[s._v("code")]),s._v("最大的基础上往上加多一条数据")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Insert into SYMENU "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ID,CODE,PARENTID,NAME,LEVELS,ICON,ALIAS,URL,METHOD,TYPE,STATUS,PAGE,CREUSER,CREOU,CRETIME,MODOU,MODUSER,MODTIME,SYS,COLOR,NOTES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" values "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'EDD3742CDE564CB79D78D6AB553A7F48'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'005000010306'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'595543FC55164C7389247876ED35A25F'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'消息通知发布权限'")]),s._v(",2,null,null,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'messageSend'")]),s._v(",null,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'role'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),s._v(",null,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DE64C89F78E64260B450A69DF64ADEC3'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'00000000000000000000000000000000'")]),s._v(",to_date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'31-8月 -16'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DD-MON-RR'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",null,null,null,null,null,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'是否有权限发布消息通知'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("其中"),a("code",[s._v("messageSend")]),s._v("为权限标识，用于 接口获取某个固定权限所用到的参数值")]),s._v(" "),a("p",[s._v("之后请求接口："),a("code",[s._v("security/check/check.do?action=getSpecialrole")]),a("br"),s._v("\n传递的参数"),a("code",[s._v("filter: {url: ['权限标识']}")])])])}),[],!1,null,null,null);t.default=r.exports}}]);